"""
This module cleans the data provided on kaggle and remove unnecessary columns
"""
import os
import pandas as pd
from pprint import pprint

desired_width = 320
pd.set_option('display.width', desired_width)
pd.set_option('display.max_columns', 20)


def clean_kaggle_data(source_filenames: list, save_filenames: list, cols_to_remove: list):
    dfs = []
    for name in source_filenames:
        dfs.append(pd.read_csv(os.path.join(os.path.dirname(__file__), name).replace("\\", "/")))

    for i in range(len(dfs)):
        # Filter columns based on whether any string from the list is present in the column name
        columns_to_keep = [col for col in dfs[i].columns if not any(s in col for s in cols_to_remove)]
        # Create a new DataFrame with the selected columns
        dfs[i] = dfs[i][columns_to_keep]

        # ffill down for the columns that have hourly data
        dfs[i].ffill(axis=0, inplace=True)

        # Save the prepared dataframes
        dfs[i].to_csv(os.path.join(os.path.dirname(__file__), "ready_for_use", save_filenames[i]).replace("\\", "/"))

    return dfs[0]


if __name__ == "__main__":
    # List of strings to check for in column names
    strings_to_remove = ['id', 'Belfast', 'Birmingham', 'Glasgow', 'London', 'Southampton', 'Portsmouth', 'Birmingham',
                         'timezone', 'utc_offset', 'longitude', 'latitude', 'population', 'location', 'elevation',
                         'generationtime']

    df = clean_kaggle_data(source_filenames=["test_data.csv", "train_data.csv"],
                           save_filenames=["prepared_test_data.csv", "prepared_train_data.csv"],
                           cols_to_remove=strings_to_remove)

"""
ALL THE COLUMNS

['id',
 'UTC_Settlement_DateTime',
 'East_Midlands_price',
 'Eastern_England_price',
 'London_price',
 'Merseyside_and_Northern_Wales_price',
 'North_Western_England_price',
 'Northern_Scotland_price',
 'South_Western_England_price',
 'Southern_England_price',
 'Southern_Scotland_price',
 'West_Midlands_price',
 'Yorkshire_price',
 'temperature_2mBelfast_weather',
 'relativehumidity_2mBelfast_weather',
 'dewpoint_2mBelfast_weather',
 'apparent_temperatureBelfast_weather',
 'precipitationBelfast_weather',
 'rainBelfast_weather',
 'snowfallBelfast_weather',
 'weathercodeBelfast_weather',
 'surface_pressureBelfast_weather',
 'cloudcoverBelfast_weather',
 'cloudcover_lowBelfast_weather',
 'cloudcover_midBelfast_weather',
 'cloudcover_highBelfast_weather',
 'windspeed_10mBelfast_weather',
 'windspeed_100mBelfast_weather',
 'winddirection_10mBelfast_weather',
 'winddirection_100mBelfast_weather',
 'windgusts_10mBelfast_weather',
 'is_dayBelfast_weather',
 'locationBelfast_weather',
 'populationBelfast_weather',
 'latitudeBelfast_weather',
 'longitudeBelfast_weather',
 'generationtime_msBelfast_weather',
 'utc_offset_secondsBelfast_weather',
 'timezoneBelfast_weather',
 'timezone_abbreviationBelfast_weather',
 'elevationBelfast_weather',
 'temperature_2mBirmingham_weather',
 'relativehumidity_2mBirmingham_weather',
 'dewpoint_2mBirmingham_weather',
 'apparent_temperatureBirmingham_weather',
 'precipitationBirmingham_weather',
 'rainBirmingham_weather',
 'snowfallBirmingham_weather',
 'weathercodeBirmingham_weather',
 'surface_pressureBirmingham_weather',
 'cloudcoverBirmingham_weather',
 'cloudcover_lowBirmingham_weather',
 'cloudcover_midBirmingham_weather',
 'cloudcover_highBirmingham_weather',
 'windspeed_10mBirmingham_weather',
 'windspeed_100mBirmingham_weather',
 'winddirection_10mBirmingham_weather',
 'winddirection_100mBirmingham_weather',
 'windgusts_10mBirmingham_weather',
 'is_dayBirmingham_weather',
 'locationBirmingham_weather',
 'populationBirmingham_weather',
 'latitudeBirmingham_weather',
 'longitudeBirmingham_weather',
 'generationtime_msBirmingham_weather',
 'utc_offset_secondsBirmingham_weather',
 'timezoneBirmingham_weather',
 'timezone_abbreviationBirmingham_weather',
 'elevationBirmingham_weather',
 'temperature_2mGlasgow_weather',
 'relativehumidity_2mGlasgow_weather',
 'dewpoint_2mGlasgow_weather',
 'apparent_temperatureGlasgow_weather',
 'precipitationGlasgow_weather',
 'rainGlasgow_weather',
 'snowfallGlasgow_weather',
 'weathercodeGlasgow_weather',
 'surface_pressureGlasgow_weather',
 'cloudcoverGlasgow_weather',
 'cloudcover_lowGlasgow_weather',
 'cloudcover_midGlasgow_weather',
 'cloudcover_highGlasgow_weather',
 'windspeed_10mGlasgow_weather',
 'windspeed_100mGlasgow_weather',
 'winddirection_10mGlasgow_weather',
 'winddirection_100mGlasgow_weather',
 'windgusts_10mGlasgow_weather',
 'is_dayGlasgow_weather',
 'locationGlasgow_weather',
 'populationGlasgow_weather',
 'latitudeGlasgow_weather',
 'longitudeGlasgow_weather',
 'generationtime_msGlasgow_weather',
 'utc_offset_secondsGlasgow_weather',
 'timezoneGlasgow_weather',
 'timezone_abbreviationGlasgow_weather',
 'elevationGlasgow_weather',
 'temperature_2mLeeds_weather',
 'relativehumidity_2mLeeds_weather',
 'dewpoint_2mLeeds_weather',
 'apparent_temperatureLeeds_weather',
 'precipitationLeeds_weather',
 'rainLeeds_weather',
 'snowfallLeeds_weather',
 'weathercodeLeeds_weather',
 'surface_pressureLeeds_weather',
 'cloudcoverLeeds_weather',
 'cloudcover_lowLeeds_weather',
 'cloudcover_midLeeds_weather',
 'cloudcover_highLeeds_weather',
 'windspeed_10mLeeds_weather',
 'windspeed_100mLeeds_weather',
 'winddirection_10mLeeds_weather',
 'winddirection_100mLeeds_weather',
 'windgusts_10mLeeds_weather',
 'is_dayLeeds_weather',
 'locationLeeds_weather',
 'populationLeeds_weather',
 'latitudeLeeds_weather',
 'longitudeLeeds_weather',
 'generationtime_msLeeds_weather',
 'utc_offset_secondsLeeds_weather',
 'timezoneLeeds_weather',
 'timezone_abbreviationLeeds_weather',
 'elevationLeeds_weather',
 'temperature_2mLiverpool_weather',
 'relativehumidity_2mLiverpool_weather',
 'dewpoint_2mLiverpool_weather',
 'apparent_temperatureLiverpool_weather',
 'precipitationLiverpool_weather',
 'rainLiverpool_weather',
 'snowfallLiverpool_weather',
 'weathercodeLiverpool_weather',
 'surface_pressureLiverpool_weather',
 'cloudcoverLiverpool_weather',
 'cloudcover_lowLiverpool_weather',
 'cloudcover_midLiverpool_weather',
 'cloudcover_highLiverpool_weather',
 'windspeed_10mLiverpool_weather',
 'windspeed_100mLiverpool_weather',
 'winddirection_10mLiverpool_weather',
 'winddirection_100mLiverpool_weather',
 'windgusts_10mLiverpool_weather',
 'is_dayLiverpool_weather',
 'locationLiverpool_weather',
 'populationLiverpool_weather',
 'latitudeLiverpool_weather',
 'longitudeLiverpool_weather',
 'generationtime_msLiverpool_weather',
 'utc_offset_secondsLiverpool_weather',
 'timezoneLiverpool_weather',
 'timezone_abbreviationLiverpool_weather',
 'elevationLiverpool_weather',
 'temperature_2mLondon_weather',
 'relativehumidity_2mLondon_weather',
 'dewpoint_2mLondon_weather',
 'apparent_temperatureLondon_weather',
 'precipitationLondon_weather',
 'rainLondon_weather',
 'snowfallLondon_weather',
 'weathercodeLondon_weather',
 'surface_pressureLondon_weather',
 'cloudcoverLondon_weather',
 'cloudcover_lowLondon_weather',
 'cloudcover_midLondon_weather',
 'cloudcover_highLondon_weather',
 'windspeed_10mLondon_weather',
 'windspeed_100mLondon_weather',
 'winddirection_10mLondon_weather',
 'winddirection_100mLondon_weather',
 'windgusts_10mLondon_weather',
 'is_dayLondon_weather',
 'locationLondon_weather',
 'populationLondon_weather',
 'latitudeLondon_weather',
 'longitudeLondon_weather',
 'generationtime_msLondon_weather',
 'utc_offset_secondsLondon_weather',
 'timezoneLondon_weather',
 'timezone_abbreviationLondon_weather',
 'elevationLondon_weather',
 'temperature_2mManchester_weather',
 'relativehumidity_2mManchester_weather',
 'dewpoint_2mManchester_weather',
 'apparent_temperatureManchester_weather',
 'precipitationManchester_weather',
 'rainManchester_weather',
 'snowfallManchester_weather',
 'weathercodeManchester_weather',
 'surface_pressureManchester_weather',
 'cloudcoverManchester_weather',
 'cloudcover_lowManchester_weather',
 'cloudcover_midManchester_weather',
 'cloudcover_highManchester_weather',
 'windspeed_10mManchester_weather',
 'windspeed_100mManchester_weather',
 'winddirection_10mManchester_weather',
 'winddirection_100mManchester_weather',
 'windgusts_10mManchester_weather',
 'is_dayManchester_weather',
 'locationManchester_weather',
 'populationManchester_weather',
 'latitudeManchester_weather',
 'longitudeManchester_weather',
 'generationtime_msManchester_weather',
 'utc_offset_secondsManchester_weather',
 'timezoneManchester_weather',
 'timezone_abbreviationManchester_weather',
 'elevationManchester_weather',
 'temperature_2mNewcastle upon Tyne_weather',
 'relativehumidity_2mNewcastle upon Tyne_weather',
 'dewpoint_2mNewcastle upon Tyne_weather',
 'apparent_temperatureNewcastle upon Tyne_weather',
 'precipitationNewcastle upon Tyne_weather',
 'rainNewcastle upon Tyne_weather',
 'snowfallNewcastle upon Tyne_weather',
 'weathercodeNewcastle upon Tyne_weather',
 'surface_pressureNewcastle upon Tyne_weather',
 'cloudcoverNewcastle upon Tyne_weather',
 'cloudcover_lowNewcastle upon Tyne_weather',
 'cloudcover_midNewcastle upon Tyne_weather',
 'cloudcover_highNewcastle upon Tyne_weather',
 'windspeed_10mNewcastle upon Tyne_weather',
 'windspeed_100mNewcastle upon Tyne_weather',
 'winddirection_10mNewcastle upon Tyne_weather',
 'winddirection_100mNewcastle upon Tyne_weather',
 'windgusts_10mNewcastle upon Tyne_weather',
 'is_dayNewcastle upon Tyne_weather',
 'locationNewcastle upon Tyne_weather',
 'populationNewcastle upon Tyne_weather',
 'latitudeNewcastle upon Tyne_weather',
 'longitudeNewcastle upon Tyne_weather',
 'generationtime_msNewcastle upon Tyne_weather',
 'utc_offset_secondsNewcastle upon Tyne_weather',
 'timezoneNewcastle upon Tyne_weather',
 'timezone_abbreviationNewcastle upon Tyne_weather',
 'elevationNewcastle upon Tyne_weather',
 'temperature_2mSheffield_weather',
 'relativehumidity_2mSheffield_weather',
 'dewpoint_2mSheffield_weather',
 'apparent_temperatureSheffield_weather',
 'precipitationSheffield_weather',
 'rainSheffield_weather',
 'snowfallSheffield_weather',
 'weathercodeSheffield_weather',
 'surface_pressureSheffield_weather',
 'cloudcoverSheffield_weather',
 'cloudcover_lowSheffield_weather',
 'cloudcover_midSheffield_weather',
 'cloudcover_highSheffield_weather',
 'windspeed_10mSheffield_weather',
 'windspeed_100mSheffield_weather',
 'winddirection_10mSheffield_weather',
 'winddirection_100mSheffield_weather',
 'windgusts_10mSheffield_weather',
 'is_daySheffield_weather',
 'locationSheffield_weather',
 'populationSheffield_weather',
 'latitudeSheffield_weather',
 'longitudeSheffield_weather',
 'generationtime_msSheffield_weather',
 'utc_offset_secondsSheffield_weather',
 'timezoneSheffield_weather',
 'timezone_abbreviationSheffield_weather',
 'elevationSheffield_weather',
 'temperature_2mSouthhampton - Portsmouth_weather',
 'relativehumidity_2mSouthhampton - Portsmouth_weather',
 'dewpoint_2mSouthhampton - Portsmouth_weather',
 'apparent_temperatureSouthhampton - Portsmouth_weather',
 'precipitationSouthhampton - Portsmouth_weather',
 'rainSouthhampton - Portsmouth_weather',
 'snowfallSouthhampton - Portsmouth_weather',
 'weathercodeSouthhampton - Portsmouth_weather',
 'surface_pressureSouthhampton - Portsmouth_weather',
 'cloudcoverSouthhampton - Portsmouth_weather',
 'cloudcover_lowSouthhampton - Portsmouth_weather',
 'cloudcover_midSouthhampton - Portsmouth_weather',
 'cloudcover_highSouthhampton - Portsmouth_weather',
 'windspeed_10mSouthhampton - Portsmouth_weather',
 'windspeed_100mSouthhampton - Portsmouth_weather',
 'winddirection_10mSouthhampton - Portsmouth_weather',
 'winddirection_100mSouthhampton - Portsmouth_weather',
 'windgusts_10mSouthhampton - Portsmouth_weather',
 'is_daySouthhampton - Portsmouth_weather',
 'locationSouthhampton - Portsmouth_weather',
 'populationSouthhampton - Portsmouth_weather',
 'latitudeSouthhampton - Portsmouth_weather',
 'longitudeSouthhampton - Portsmouth_weather',
 'generationtime_msSouthhampton - Portsmouth_weather',
 'utc_offset_secondsSouthhampton - Portsmouth_weather',
 'timezoneSouthhampton - Portsmouth_weather',
 'timezone_abbreviationSouthhampton - Portsmouth_weather',
 'elevationSouthhampton - Portsmouth_weather']
"""
